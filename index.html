<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ö° –û–ª–∏–º–ø–∏–∞–¥–Ω–∞—è –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ | –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –æ–ª–∏–º–ø–∏–∞–¥–∞–º</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Arial', sans-serif;
        }

        :root {
            --neon-blue: #00f3ff;
            --neon-purple: #b967ff;
            --neon-pink: #ff00ff;
            --neon-green: #00ff9d;
            --dark-bg: #0a0a1a;
            --darker-bg: #050510;
            --card-bg: rgba(20, 20, 40, 0.8);
            --text-light: #ffffff;
            --text-dim: #a0a0c0;
            --shadow-glow: 0 0 15px rgba(0, 243, 255, 0.5);
            --shadow-glow-purple: 0 0 15px rgba(185, 103, 255, 0.5);
            --gradient-blue: linear-gradient(135deg, #00f3ff, #b967ff);
            --gradient-purple: linear-gradient(135deg, #b967ff, #ff00ff);
        }

        body {
            background: var(--dark-bg);
            color: var(--text-light);
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(0, 243, 255, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(185, 103, 255, 0.1) 0%, transparent 20%);
            overflow-x: hidden;
        }

        .neon-text {
            text-shadow: 0 0 10px var(--neon-blue), 0 0 20px var(--neon-blue);
            color: var(--text-light);
        }

        .neon-border {
            border: 2px solid var(--neon-blue);
            box-shadow: var(--shadow-glow);
        }

        .neon-button {
            background: transparent;
            color: var(--neon-blue);
            border: 2px solid var(--neon-blue);
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .neon-button:hover {
            background: rgba(0, 243, 255, 0.1);
            box-shadow: 0 0 20px var(--neon-blue);
            transform: translateY(-2px);
        }

        .neon-button.purple {
            border-color: var(--neon-purple);
            color: var(--neon-purple);
        }

        .neon-button.purple:hover {
            box-shadow: 0 0 20px var(--neon-purple);
            background: rgba(185, 103, 255, 0.1);
        }

        .neon-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(0, 243, 255, 0.3);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .neon-card:hover {
            border-color: var(--neon-blue);
            box-shadow: var(--shadow-glow);
            transform: translateY(-5px);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(0, 243, 255, 0.3);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            font-size: 2.5em;
            color: var(--neon-blue);
            text-shadow: 0 0 15px var(--neon-blue);
        }

        .logo h1 {
            font-size: 2em;
            background: var(--gradient-blue);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }

        .user-panel {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            background: rgba(20, 20, 40, 0.8);
            border-radius: 8px;
            border: 1px solid rgba(0, 243, 255, 0.3);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: var(--gradient-blue);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
        }

        .user-rating {
            color: var(--neon-green);
            font-weight: bold;
            font-size: 1.1em;
        }

        .nav-tabs {
            display: flex;
            gap: 5px;
            background: rgba(10, 10, 30, 0.8);
            padding: 10px;
            border-radius: 12px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-tab {
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
            color: var(--text-dim);
        }

        .nav-tab:hover {
            background: rgba(0, 243, 255, 0.1);
            color: var(--neon-blue);
        }

        .nav-tab.active {
            background: var(--gradient-blue);
            color: white;
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.5);
        }

        .nav-tab i {
            font-size: 1.2em;
        }

        .content-panel {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .content-panel.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .panel-header h2 {
            font-size: 1.8em;
            background: var(--gradient-blue);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .auth-container {
            max-width: 500px;
            margin: 50px auto;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 30px;
            gap: 10px;
        }

        .auth-form {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 12px;
            border: 1px solid rgba(0, 243, 255, 0.3);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-dim);
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .form-input {
            width: 100%;
            padding: 15px;
            background: rgba(10, 10, 30, 0.8);
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 8px;
            color: white;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--neon-blue);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.3);
        }

        .problems-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .problem-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid rgba(0, 243, 255, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .problem-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 243, 255, 0.1), transparent);
            transition: 0.5s;
        }

        .problem-card:hover::before {
            left: 100%;
        }

        .problem-card:hover {
            border-color: var(--neon-blue);
            box-shadow: var(--shadow-glow);
            transform: translateY(-5px);
        }

        .problem-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .problem-title {
            font-size: 1.3em;
            font-weight: bold;
            color: white;
            flex: 1;
        }

        .problem-difficulty {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .difficulty-easy {
            background: rgba(0, 255, 157, 0.2);
            color: var(--neon-green);
            border: 1px solid var(--neon-green);
        }

        .difficulty-medium {
            background: rgba(255, 215, 0, 0.2);
            color: #ffd700;
            border: 1px solid #ffd700;
        }

        .difficulty-hard {
            background: rgba(255, 0, 0, 0.2);
            color: #ff5555;
            border: 1px solid #ff5555;
        }

        .problem-category {
            display: inline-block;
            padding: 5px 10px;
            background: rgba(185, 103, 255, 0.2);
            color: var(--neon-purple);
            border-radius: 6px;
            font-size: 0.8em;
            margin-bottom: 15px;
            border: 1px solid rgba(185, 103, 255, 0.3);
        }

        .problem-description {
            color: var(--text-dim);
            line-height: 1.6;
            margin-bottom: 20px;
            min-height: 60px;
        }

        .problem-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .tag {
            padding: 4px 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            font-size: 0.8em;
            color: var(--text-dim);
        }

        .solve-form {
            display: flex;
            gap: 10px;
        }

        .solve-input {
            flex: 1;
            padding: 12px;
            background: rgba(10, 10, 30, 0.8);
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 8px;
            color: white;
        }

        .solve-button {
            background: var(--gradient-blue);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .solve-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.5);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            border: 1px solid rgba(0, 243, 255, 0.3);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: var(--neon-blue);
            box-shadow: var(--shadow-glow);
        }

        .stat-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
            color: var(--neon-blue);
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: white;
            margin-bottom: 10px;
        }

        .stat-label {
            color: var(--text-dim);
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .leaderboard-table {
            width: 100%;
            background: var(--card-bg);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(0, 243, 255, 0.3);
        }

        .leaderboard-table th {
            background: rgba(0, 243, 255, 0.1);
            padding: 15px;
            text-align: left;
            color: var(--neon-blue);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9em;
        }

        .leaderboard-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .leaderboard-table tr:hover {
            background: rgba(0, 243, 255, 0.05);
        }

        .leaderboard-table tr:last-child td {
            border-bottom: none;
        }

        .rank {
            width: 60px;
            text-align: center;
            font-weight: bold;
        }

        .rank-1 { color: gold; }
        .rank-2 { color: silver; }
        .rank-3 { color: #cd7f32; }

        .username-cell {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-rank-badge {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9em;
        }

        .rank-1-badge { background: gold; color: black; }
        .rank-2-badge { background: silver; color: black; }
        .rank-3-badge { background: #cd7f32; color: white; }
        .rank-other-badge { background: rgba(0, 243, 255, 0.2); color: var(--neon-blue); }

        .pvp-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        @media (max-width: 992px) {
            .pvp-container {
                grid-template-columns: 1fr;
            }
        }

        .match-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid rgba(0, 243, 255, 0.3);
        }

        .match-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 20px;
        }

        .status-waiting {
            background: rgba(255, 215, 0, 0.2);
            color: #ffd700;
            border: 1px solid #ffd700;
        }

        .status-active {
            background: rgba(0, 255, 157, 0.2);
            color: var(--neon-green);
            border: 1px solid var(--neon-green);
        }

        .status-finished {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-dim);
            border: 1px solid var(--text-dim);
        }

        .players-info {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 30px 0;
        }

        .player {
            text-align: center;
        }

        .player-name {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .player-rating {
            color: var(--neon-green);
            font-weight: bold;
        }

        .vs {
            font-size: 2em;
            color: var(--neon-purple);
            font-weight: bold;
            text-shadow: 0 0 10px var(--neon-purple);
        }

        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .admin-section {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid rgba(255, 0, 255, 0.3);
        }

        .admin-section h3 {
            color: var(--neon-pink);
            margin-bottom: 20px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-section h3 i {
            color: var(--neon-pink);
        }

        .user-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .user-item:last-child {
            border-bottom: none;
        }

        .user-details {
            flex: 1;
        }

        .user-role {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
            text-transform: uppercase;
        }

        .role-admin {
            background: rgba(255, 0, 255, 0.2);
            color: var(--neon-pink);
            border: 1px solid var(--neon-pink);
        }

        .role-user {
            background: rgba(0, 243, 255, 0.2);
            color: var(--neon-blue);
            border: 1px solid var(--neon-blue);
        }

        .user-actions {
            display: flex;
            gap: 10px;
        }

        .action-button {
            padding: 5px 10px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s ease;
        }

        .edit-button {
            background: rgba(255, 215, 0, 0.2);
            color: #ffd700;
            border: 1px solid #ffd700;
        }

        .delete-button {
            background: rgba(255, 0, 0, 0.2);
            color: #ff5555;
            border: 1px solid #ff5555;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideInRight 0.3s ease, fadeOut 0.3s ease 2.7s;
            animation-fill-mode: forwards;
            max-width: 400px;
            backdrop-filter: blur(10px);
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes fadeOut {
            to { opacity: 0; }
        }

        .notification.success {
            background: rgba(0, 255, 157, 0.2);
            border: 1px solid var(--neon-green);
            box-shadow: 0 0 15px rgba(0, 255, 157, 0.3);
        }

        .notification.error {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid #ff5555;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        }

        .notification.info {
            background: rgba(0, 243, 255, 0.2);
            border: 1px solid var(--neon-blue);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.3);
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }

            .nav-tabs {
                justify-content: center;
            }

            .nav-tab {
                padding: 10px 15px;
                font-size: 0.9em;
            }

            .problems-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .admin-grid {
                grid-template-columns: 1fr;
            }

            .user-panel {
                flex-direction: column;
                gap: 10px;
            }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .float {
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">
                <div class="logo-icon">‚ö°</div>
                <h1>–û–ª–∏–º–ø–∏–∞–¥–Ω–∞—è –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞</h1>
            </div>
            
            <div class="user-panel" id="userPanel" style="display: none;">
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <div>
                        <div id="userName"></div>
                        <div class="user-rating">üèÜ <span id="userRating">1000</span></div>
                    </div>
                </div>
                <button class="neon-button purple" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
                </button>
            </div>
        </header>

        <nav class="nav-tabs" id="navTabs" style="display: none;">
            <div class="nav-tab active" onclick="showPanel('problems')">
                <i class="fas fa-tasks"></i> –ó–∞–¥–∞—á–∏
            </div>
            <div class="nav-tab" onclick="showPanel('pvp')">
                <i class="fas fa-gamepad"></i> PvP –ú–∞—Ç—á–∏
            </div>
            <div class="nav-tab" onclick="showPanel('stats')">
                <i class="fas fa-chart-line"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            </div>
            <div class="nav-tab" onclick="showPanel('leaderboard')">
                <i class="fas fa-trophy"></i> –õ–∏–¥–µ—Ä–±–æ—Ä–¥
            </div>
            <div class="nav-tab admin-tab" onclick="showPanel('admin')" style="display: none;">
                <i class="fas fa-crown"></i> –ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª—å
            </div>
        </nav>

        <div class="content-panel active" id="authPanel">
            <div class="auth-container">
                <div class="auth-tabs">
                    <button class="neon-button active" onclick="showAuthTab('login')" style="flex: 1;">–í—Ö–æ–¥</button>
                    <button class="neon-button purple" onclick="showAuthTab('register')" style="flex: 1;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>

                <div class="auth-form" id="loginForm">
                    <h2 class="neon-text" style="margin-bottom: 30px; text-align: center;">–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
                    <div class="form-group">
                        <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                        <input type="text" id="loginUsername" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                    </div>
                    <div class="form-group">
                        <label>–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="loginPassword" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                    </div>
                    <div class="form-group">
                        <button class="neon-button" style="width: 100%;" onclick="login()">
                            <i class="fas fa-sign-in-alt"></i> –í–æ–π—Ç–∏
                        </button>
                    </div>
                    <div style="text-align: center; color: var(--text-dim); margin-top: 20px;">
                        –¢–µ—Å—Ç–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã:<br>
                        üëë –ê–¥–º–∏–Ω: admin / admin123<br>
                        üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: test / test123
                    </div>
                </div>

                <div class="auth-form" id="registerForm" style="display: none;">
                    <h2 class="neon-text" style="margin-bottom: 30px; text-align: center;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
                    <div class="form-group">
                        <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è *</label>
                        <input type="text" id="regUsername" class="form-input" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                    </div>
                    <div class="form-group">
                        <label>Email (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                        <input type="email" id="regEmail" class="form-input" placeholder="–í–∞—à email">
                    </div>
                    <div class="form-group">
                        <label>–ü–∞—Ä–æ–ª—å *</label>
                        <input type="password" id="regPassword" class="form-input" placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤">
                    </div>
                    <div class="form-group">
                        <button class="neon-button purple" style="width: 100%;" onclick="register()">
                            <i class="fas fa-user-plus"></i> –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-panel" id="problemsPanel">
            <div class="panel-header">
                <h2><i class="fas fa-tasks"></i> –ö–∞—Ç–∞–ª–æ–≥ –∑–∞–¥–∞—á</h2>
                <div style="display: flex; gap: 10px;">
                    <select id="categoryFilter" class="form-input" style="width: 200px;">
                        <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                        <option value="–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞">–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞</option>
                        <option value="–ê–ª–≥–µ–±—Ä–∞">–ê–ª–≥–µ–±—Ä–∞</option>
                        <option value="–ì–µ–æ–º–µ—Ç—Ä–∏—è">–ì–µ–æ–º–µ—Ç—Ä–∏—è</option>
                        <option value="–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞">–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞</option>
                    </select>
                    <select id="difficultyFilter" class="form-input" style="width: 200px;">
                        <option value="">–õ—é–±–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å</option>
                        <option value="1">–õ–µ–≥–∫–∏–µ</option>
                        <option value="2">–°—Ä–µ–¥–Ω–∏–µ</option>
                        <option value="3">–°–ª–æ–∂–Ω—ã–µ</option>
                    </select>
                    <button class="neon-button" onclick="loadProblems()">
                        <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                    </button>
                </div>
            </div>
            <div class="problems-grid" id="problemsGrid">
            </div>
            <div id="problemsLoading" style="text-align: center; padding: 40px;">
                <div class="pulse" style="font-size: 3em; color: var(--neon-blue);">‚ö°</div>
                <p style="color: var(--text-dim); margin-top: 20px;">–ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–¥–∞—á–∏...</p>
            </div>
        </div>

        <div class="content-panel" id="pvpPanel">
            <div class="panel-header">
                <h2><i class="fas fa-gamepad"></i> PvP –ú–∞—Ç—á–∏</h2>
                <button class="neon-button purple" onclick="createMatch()">
                    <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –º–∞—Ç—á
                </button>
            </div>
            
            <div class="pvp-container">
                <div>
                    <h3 style="color: var(--neon-blue); margin-bottom: 20px;">–ê–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ç—á–∏</h3>
                    <div id="activeMatches" class="match-card">
                        <div id="matchesLoading" style="text-align: center; padding: 30px;">
                            <div class="pulse" style="color: var(--neon-blue);">–ó–∞–≥—Ä—É–∂–∞–µ–º –º–∞—Ç—á–∏...</div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 style="color: var(--neon-purple); margin-bottom: 20px;">–¢–µ–∫—É—â–∏–π –º–∞—Ç—á</h3>
                    <div id="currentMatch" class="match-card">
                        <div style="text-align: center; padding: 50px; color: var(--text-dim);">
                            <i class="fas fa-gamepad" style="font-size: 3em; margin-bottom: 20px;"></i>
                            <p>–£—á–∞—Å—Ç–≤—É–π—Ç–µ –≤ –º–∞—Ç—á–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-panel" id="statsPanel">
            <div class="panel-header">
                <h2><i class="fas fa-chart-line"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
            </div>
            
            <div class="stats-grid" id="platformStats">
                <div class="stat-card float">
                    <div class="stat-icon"><i class="fas fa-users"></i></div>
                    <div class="stat-value" id="totalUsers">0</div>
                    <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
                <div class="stat-card float" style="animation-delay: 0.2s;">
                    <div class="stat-icon"><i class="fas fa-tasks"></i></div>
                    <div class="stat-value" id="totalProblems">0</div>
                    <div class="stat-label">–ó–∞–¥–∞—á</div>
                </div>
                <div class="stat-card float" style="animation-delay: 0.4s;">
                    <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                    <div class="stat-value" id="correctSolutions">0</div>
                    <div class="stat-label">–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π</div>
                </div>
                <div class="stat-card float" style="animation-delay: 0.6s;">
                    <div class="stat-icon"><i class="fas fa-trophy"></i></div>
                    <div class="stat-value" id="matchesPlayed">0</div>
                    <div class="stat-label">–°—ã–≥—Ä–∞–Ω–æ –º–∞—Ç—á–µ–π</div>
                </div>
            </div>
            
            <h3 style="color: var(--neon-green); margin: 40px 0 20px 0;">–í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <div id="userStats" style="background: var(--card-bg); padding: 25px; border-radius: 12px;">
                <div style="text-align: center; padding: 30px; color: var(--text-dim);">
                    –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...
                </div>
            </div>
        </div>

        <div class="content-panel" id="leaderboardPanel">
            <div class="panel-header">
                <h2><i class="fas fa-trophy"></i> –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</h2>
                <button class="neon-button" onclick="loadLeaderboard()">
                    <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                </button>
            </div>
            
            <div class="leaderboard-table">
                <table style="width: 100%;">
                    <thead>
                        <tr>
                            <th class="rank">–ú–µ—Å—Ç–æ</th>
                            <th>–ò–≥—Ä–æ–∫</th>
                            <th>–†–µ–π—Ç–∏–Ω–≥</th>
                            <th>–†–µ—à–µ–Ω–æ</th>
                            <th>–ü—Ä–∞–≤–∏–ª—å–Ω–æ</th>
                            <th>–¢–æ—á–Ω–æ—Å—Ç—å</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboardBody">
                        <tr>
                            <td colspan="6" style="text-align: center; padding: 50px; color: var(--text-dim);">
                                –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="content-panel" id="adminPanel">
            <div class="panel-header">
                <h2><i class="fas fa-crown"></i> –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å</h2>
            </div>
            
            <div class="admin-grid">
                <div class="admin-section">
                    <h3><i class="fas fa-users-cog"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
                    <div style="margin-bottom: 20px;">
                        <button class="neon-button purple" onclick="showAddUserModal()" style="width: 100%;">
                            <i class="fas fa-user-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        </button>
                    </div>
                    <div class="user-list" id="userList">
                    </div>
                </div>
                
                <div class="admin-section">
                    <h3><i class="fas fa-tasks"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏</h3>
                    <div style="margin-bottom: 20px;">
                        <button class="neon-button" onclick="showAddProblemModal()" style="width: 100%;">
                            <i class="fas fa-plus-circle"></i> –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É
                        </button>
                    </div>
                    <div style="color: var(--text-dim);">
                        –í—Å–µ–≥–æ –∑–∞–¥–∞—á: <span id="totalProblemsAdmin">0</span><br>
                        –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É –≤—ã—à–µ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
                    </div>
                </div>
                
                <div class="admin-section">
                    <h3><i class="fas fa-chart-pie"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</h3>
                    <div id="adminStats">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="modalOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 1000; backdrop-filter: blur(5px);">
        <div id="addProblemModal" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 600px; background: var(--card-bg); padding: 30px; border-radius: 12px; border: 2px solid var(--neon-blue);">
            <h2 class="neon-text" style="margin-bottom: 20px;">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</h2>
            <div class="form-group">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</label>
                <input type="text" id="modalProblemTitle" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
            </div>
            <div class="form-group">
                <label>–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</label>
                <textarea id="modalProblemDesc" class="form-input" rows="4" placeholder="–û–ø–∏—à–∏—Ç–µ –∑–∞–¥–∞—á—É"></textarea>
            </div>
            <div class="form-group">
                <label>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç</label>
                <input type="text" id="modalProblemAnswer" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç">
            </div>
            <div class="form-group" style="display: flex; gap: 10px;">
                <div style="flex: 1;">
                    <label>–°–ª–æ–∂–Ω–æ—Å—Ç—å</label>
                    <select id="modalProblemDifficulty" class="form-input">
                        <option value="1">–õ–µ–≥–∫–∞—è</option>
                        <option value="2">–°—Ä–µ–¥–Ω—è—è</option>
                        <option value="3">–°–ª–æ–∂–Ω–∞—è</option>
                    </select>
                </div>
                <div style="flex: 1;">
                    <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <input type="text" id="modalProblemCategory" class="form-input" placeholder="–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞">
                </div>
            </div>
            <div class="form-group">
                <label>–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                <input type="text" id="modalProblemTags" class="form-input" placeholder="–∞–ª–≥–µ–±—Ä–∞, —É—Ä–∞–≤–Ω–µ–Ω–∏—è, —Ç–µ—Å—Ç">
            </div>
            <div style="display: flex; gap: 10px; margin-top: 30px;">
                <button class="neon-button" onclick="addProblem()" style="flex: 1;">–î–æ–±–∞–≤–∏—Ç—å</button>
                <button class="neon-button purple" onclick="closeModal()" style="flex: 1;">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>

        <div id="addUserModal" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 500px; background: var(--card-bg); padding: 30px; border-radius: 12px; border: 2px solid var(--neon-purple);">
            <h2 class="neon-text" style="margin-bottom: 20px;">–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
            <div class="form-group">
                <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                <input type="text" id="modalUsername" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            </div>
            <div class="form-group">
                <label>Email (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                <input type="email" id="modalUserEmail" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ email">
            </div>
            <div class="form-group">
                <label>–ü–∞—Ä–æ–ª—å</label>
                <input type="password" id="modalUserPassword" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
            </div>
            <div class="form-group">
                <label>–†–æ–ª—å</label>
                <select id="modalUserRole" class="form-input">
                    <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                    <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                </select>
            </div>
            <div style="display: flex; gap: 10px; margin-top: 30px;">
                <button class="neon-button purple" onclick="adminAddUser()" style="flex: 1;">–î–æ–±–∞–≤–∏—Ç—å</button>
                <button class="neon-button" onclick="closeModal()" style="flex: 1;">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>

        <div id="editUserModal" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 500px; background: var(--card-bg); padding: 30px; border-radius: 12px; border: 2px solid var(--neon-pink);">
            <h2 class="neon-text" style="margin-bottom: 20px;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
            <input type="hidden" id="editUserId">
            <div class="form-group">
                <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                <input type="text" id="editUsername" class="form-input" readonly>
            </div>
            <div class="form-group">
                <label>–†–µ–π—Ç–∏–Ω–≥</label>
                <input type="number" id="editUserRating" class="form-input">
            </div>
            <div class="form-group">
                <label>–†–æ–ª—å</label>
                <select id="editUserRole" class="form-input">
                    <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                    <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                </select>
            </div>
            <div style="display: flex; gap: 10px; margin-top: 30px;">
                <button class="neon-button" onclick="adminUpdateUser()" style="flex: 1;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="neon-button purple" onclick="closeModal()" style="flex: 1;">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <script>
        let ws = null;
        let currentUser = null;
        let currentMatch = null;
        let wsConnected = false;

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }

        function showPanel(panelId) {
            document.querySelectorAll('.content-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(panelId + 'Panel').classList.add('active');
            document.querySelector(`.nav-tab:nth-child(${getPanelIndex(panelId)})`).classList.add('active');
            
            switch(panelId) {
                case 'problems': loadProblems(); break;
                case 'stats': loadStats(); break;
                case 'leaderboard': loadLeaderboard(); break;
                case 'pvp': loadActiveMatches(); break;
                case 'admin': loadAdminData(); break;
            }
        }

        function getPanelIndex(panelId) {
            const panels = ['problems', 'pvp', 'stats', 'leaderboard', 'admin'];
            return panels.indexOf(panelId) + 1;
        }

        function showAuthTab(tab) {
            document.getElementById('loginForm').style.display = tab === 'login' ? 'block' : 'none';
            document.getElementById('registerForm').style.display = tab === 'register' ? 'block' : 'none';
            document.querySelector('.auth-tabs .neon-button').classList.remove('active');
            document.querySelector('.auth-tabs .neon-button.purple').classList.remove('active');
            if (tab === 'login') {
                document.querySelector('.auth-tabs .neon-button').classList.add('active');
            } else {
                document.querySelector('.auth-tabs .neon-button.purple').classList.add('active');
            }
        }

        async function login() {
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value.trim();
            
            if (!username || !password) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            try {
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({username, password})
                });
                
                const data = await response.json();
                
                if (data.success) {
                    currentUser = data.user;
                    showNotification(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${currentUser.username}!`, 'success');
                    updateUIAfterLogin();
                    loadProblems();
                } else {
                    showNotification(data.error, 'error');
                }
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º', 'error');
                console.error('Login error:', error);
            }
        }

        async function register() {
            const username = document.getElementById('regUsername').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            const password = document.getElementById('regPassword').value.trim();
            
            if (!username || !password) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—å', 'error');
                return;
            }
            
            if (password.length < 6) {
                showNotification('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤', 'error');
                return;
            }
            
            try {
                const response = await fetch('/api/register', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({username, email, password})
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    showAuthTab('login');
                    document.getElementById('loginUsername').value = username;
                } else {
                    showNotification(data.error, 'error');
                }
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º', 'error');
                console.error('Register error:', error);
            }
        }

        function logout() {
            currentUser = null;
            if (ws && wsConnected) {
                ws.close();
                wsConnected = false;
            }
            
            document.getElementById('authPanel').classList.add('active');
            document.getElementById('navTabs').style.display = 'none';
            document.getElementById('userPanel').style.display = 'none';
            
            showNotification('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã', 'info');
        }

        function updateUIAfterLogin() {
            document.getElementById('userName').textContent = currentUser.username;
            document.getElementById('userRating').textContent = currentUser.rating;
            document.getElementById('userAvatar').textContent = currentUser.username.charAt(0).toUpperCase();
            document.getElementById('userPanel').style.display = 'flex';
            document.getElementById('navTabs').style.display = 'flex';
            document.getElementById('authPanel').classList.remove('active');
            const adminTab = document.querySelector('.admin-tab');
            adminTab.style.display = currentUser.role === 'admin' ? 'flex' : 'none';
            connectWebSocket();
            showPanel('problems');
        }

        async function loadProblems() {
            const category = document.getElementById('categoryFilter').value;
            const difficulty = document.getElementById('difficultyFilter').value;
            
            let url = '/api/problems';
            const params = new URLSearchParams();
            if (category) params.append('category', category);
            if (difficulty) params.append('difficulty', difficulty);
            if (params.toString()) url += '?' + params.toString();
            
            try {
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.success) {
                    renderProblems(data.problems);
                } else {
                    showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞—á', 'error');
                }
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º', 'error');
                console.error('Load problems error:', error);
            }
        }

        function renderProblems(problems) {
            const grid = document.getElementById('problemsGrid');
            const loading = document.getElementById('problemsLoading');
            
            if (problems.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 50px; color: var(--text-dim);">
                        <i class="fas fa-search" style="font-size: 3em; margin-bottom: 20px;"></i>
                        <p>–ó–∞–¥–∞—á–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
                    </div>
                `;
                loading.style.display = 'none';
                return;
            }
            
            grid.innerHTML = problems.map(problem => `
                <div class="problem-card">
                    <div class="problem-header">
                        <div class="problem-title">${problem.title}</div>
                        <div class="problem-difficulty difficulty-${problem.difficulty === 1 ? 'easy' : problem.difficulty === 2 ? 'medium' : 'hard'}">
                            ${problem.difficulty_text}
                        </div>
                    </div>
                    <div class="problem-category">${problem.category}</div>
                    <div class="problem-description">${problem.description}</div>
                    <div class="problem-tags">
                        ${problem.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                    </div>
                    <div class="solve-form">
                        <input type="text" class="solve-input" id="answer_${problem.id}" placeholder="–í–∞—à –æ—Ç–≤–µ—Ç">
                        <button class="solve-button" onclick="submitSolution(${problem.id})">
                            <i class="fas fa-paper-plane"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å
                        </button>
                    </div>
                </div>
            `).join('');
            
            loading.style.display = 'none';
        }

        async function submitSolution(problemId) {
            if (!currentUser) {
                showNotification('–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É', 'error');
                return;
            }
            
            const answerInput = document.getElementById(`answer_${problemId}`);
            const answer = answerInput.value.trim();
            
            if (!answer) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç', 'error');
                return;
            }
            
            try {
                const startTime = Date.now();
                const response = await fetch('/api/solve', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        user_id: currentUser.id,
                        problem_id: problemId,
                        answer: answer,
                        time_spent: Math.floor(Math.random() * 300) + 30
                    })
                });
                
                const data = await response.json();
                const timeSpent = Date.now() - startTime;
                
                if (data.success) {
                    if (data.correct) {
                        showNotification(`–ü—Ä–∞–≤–∏–ª—å–Ω–æ! +${data.rating_change} –∫ —Ä–µ–π—Ç–∏–Ω–≥—É`, 'success');
                        currentUser.rating += data.rating_change;
                        document.getElementById('userRating').textContent = currentUser.rating;
                    } else {
                        showNotification(`–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${data.correct_answer}`, 'error');
                    }
                    answerInput.value = '';
                } else {
                    showNotification(data.error, 'error');
                }
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–µ—à–µ–Ω–∏—è', 'error');
                console.error('Submit solution error:', error);
            }
        }

        async function loadStats() {
            try {
                const statsResponse = await fetch('/api/stats');
                const statsData = await statsResponse.json();
                
                if (statsData.success) {
                    document.getElementById('totalUsers').textContent = statsData.stats.users_count;
                    document.getElementById('totalProblems').textContent = statsData.stats.problems_count;
                    document.getElementById('correctSolutions').textContent = statsData.stats.correct_solutions;
                    document.getElementById('matchesPlayed').textContent = statsData.stats.matches_played;
                }
                
                if (currentUser) {
                    const userStatsResponse = await fetch(`/api/user/${currentUser.id}`);
                    const userStatsData = await userStatsResponse.json();
                    
                    if (userStatsData.success) {
                        const user = userStatsData.user;
                        document.getElementById('userStats').innerHTML = `
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                                <div style="text-align: center;">
                                    <div style="font-size: 2em; color: var(--neon-blue); font-weight: bold;">${user.stats.total_problems}</div>
                                    <div style="color: var(--text-dim);">–í—Å–µ–≥–æ —Ä–µ—à–µ–Ω–æ</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 2em; color: var(--neon-green); font-weight: bold;">${user.stats.correct_answers}</div>
                                    <div style="color: var(--text-dim);">–ü—Ä–∞–≤–∏–ª—å–Ω–æ</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 2em; color: var(--neon-purple); font-weight: bold;">${user.stats.accuracy}%</div>
                                    <div style="color: var(--text-dim);">–¢–æ—á–Ω–æ—Å—Ç—å</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 2em; color: var(--neon-pink); font-weight: bold;">${user.stats.avg_time}s</div>
                                    <div style="color: var(--text-dim);">–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è</div>
                                </div>
                            </div>
                            ${user.categories.length > 0 ? `
                                <h4 style="color: var(--text-dim); margin: 30px 0 15px 0;">–ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:</h4>
                                <div style="display: flex; flex-direction: column; gap: 10px;">
                                    ${user.categories.map(cat => `
                                        <div style="background: rgba(0, 243, 255, 0.1); padding: 10px 15px; border-radius: 8px; border-left: 3px solid var(--neon-blue);">
                                            <div style="display: flex; justify-content: space-between;">
                                                <span>${cat.category}</span>
                                                <span>${cat.correct}/${cat.total} (${cat.total > 0 ? Math.round(cat.correct/cat.total*100) : 0}%)</span>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : ''}
                        `;
                    }
                }
            } catch (error) {
                console.error('Load stats error:', error);
            }
        }

        async function loadLeaderboard() {
            try {
                const response = await fetch('/api/leaderboard');
                const data = await response.json();
                
                if (data.success) {
                    renderLeaderboard(data.leaderboard);
                }
            } catch (error) {
                console.error('Load leaderboard error:', error);
            }
        }

        function renderLeaderboard(leaderboard) {
            const tbody = document.getElementById('leaderboardBody');
            
            if (leaderboard.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 50px; color: var(--text-dim);">
                            –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = leaderboard.map(player => `
                <tr>
                    <td class="rank rank-${player.rank}">${player.rank}</td>
                    <td>
                        <div class="username-cell">
                            <div class="user-rank-badge rank-${player.rank}-badge">${player.rank}</div>
                            ${player.username}
                            ${currentUser && player.id === currentUser.id ? '<span style="color: var(--neon-blue); margin-left: 5px;">(–í—ã)</span>' : ''}
                        </div>
                    </td>
                    <td style="color: var(--neon-green); font-weight: bold;">${player.rating}</td>
                    <td>${player.solved}</td>
                    <td>${player.correct}</td>
                    <td>${player.accuracy}%</td>
                </tr>
            `).join('');
        }

        async function loadActiveMatches() {
            try {
                const response = await fetch('/api/matches');
                const data = await response.json();
                
                if (data.success) {
                    renderActiveMatches(data.matches);
                }
            } catch (error) {
                console.error('Load matches error:', error);
            }
        }

        function renderActiveMatches(matches) {
            const container = document.getElementById('activeMatches');
            
            if (matches.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: var(--text-dim);">
                        <i class="fas fa-search" style="font-size: 2em; margin-bottom: 15px;"></i>
                        <p>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞—Ç—á–µ–π</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = matches.map(match => `
                <div style="background: rgba(20, 20, 40, 0.6); padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid rgba(0, 243, 255, 0.2);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <div>
                            <span class="status-${match.status.toLowerCase()} match-status">${match.status === 'waiting' ? '–û–∂–∏–¥–∞–Ω–∏–µ' : match.status === 'active' ? '–ò–¥–µ—Ç' : '–ó–∞–≤–µ—Ä—à–µ–Ω'}</span>
                        </div>
                        <div style="color: var(--text-dim); font-size: 0.9em;">
                            ${new Date(match.started_at).toLocaleTimeString()}
                        </div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-weight: bold;">${match.player1}</div>
                            <div style="font-size: 0.9em; color: var(--text-dim);">vs</div>
                            <div>${match.player2 || '–û–∂–∏–¥–∞–Ω–∏–µ...'}</div>
                        </div>
                        <div>
                            <div style="color: var(--text-dim); font-size: 0.9em; margin-bottom: 5px;">–ó–∞–¥–∞—á–∞:</div>
                            <div>${match.problem}</div>
                        </div>
                        <div>
                            ${match.status === 'waiting' ? `
                                <button class="neon-button" onclick="joinMatch(${match.id})" style="padding: 8px 15px; font-size: 0.9em;">
                                    –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è
                                </button>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        async function createMatch() {
            if (!currentUser) {
                showNotification('–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É', 'error');
                return;
            }
            
            try {
                const response = await fetch('/api/match/create', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({user_id: currentUser.id})
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    currentMatch = {id: data.match_id};
                    loadActiveMatches();
                    setupCurrentMatch(data.match_id);
                } else {
                    showNotification(data.error, 'error');
                }
            } catch (error) {
                console.error('Create match error:', error);
                showNotification('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç—á–∞', 'error');
            }
        }

        async function joinMatch(matchId) {
            if (!currentUser) {
                showNotification('–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É', 'error');
                return;
            }
            
            try {
                const response = await fetch('/api/match/join', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        user_id: currentUser.id,
                        match_id: matchId
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    currentMatch = {id: matchId};
                    setupCurrentMatch(matchId);
                    loadActiveMatches();
                } else {
                    showNotification(data.error, 'error');
                }
            } catch (error) {
                console.error('Join match error:', error);
                showNotification('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ –≤ –º–∞—Ç—á', 'error');
            }
        }

        function setupCurrentMatch(matchId) {
            const container = document.getElementById('currentMatch');
            container.innerHTML = `
                <div style="text-align: center;">
                    <div class="status-active match-status" style="margin: 0 auto 20px auto;">–ò–¥–µ—Ç –º–∞—Ç—á #${matchId}</div>
                    <div style="margin-bottom: 30px;">
                        <div style="font-size: 1.2em; font-weight: bold; margin-bottom: 10px;">–ó–∞–¥–∞—á–∞:</div>
                        <div style="background: rgba(0, 243, 255, 0.1); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                            –ó–∞–¥–∞—á–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...
                        </div>
                    </div>
                    <div class="solve-form" style="max-width: 400px; margin: 0 auto;">
                        <input type="text" id="matchAnswer" class="solve-input" placeholder="–í–∞—à –æ—Ç–≤–µ—Ç">
                        <button class="solve-button" onclick="submitMatchAnswer()">
                            <i class="fas fa-paper-plane"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å
                        </button>
                    </div>
                    <div id="matchTimer" style="margin-top: 20px; color: var(--neon-green); font-weight: bold; font-size: 1.2em;">
                        00:00
                    </div>
                </div>
            `;
            
            if (wsConnected) {
                ws.send(JSON.stringify({
                    type: 'auth',
                    user_id: currentUser.id,
                    match_id: matchId
                }));
            }
            
            startMatchTimer();
        }

        async function submitMatchAnswer() {
            if (!currentUser || !currentMatch) {
                showNotification('–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –º–∞—Ç—á–∞', 'error');
                return;
            }
            
            const answer = document.getElementById('matchAnswer').value.trim();
            if (!answer) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç', 'error');
                return;
            }
            
            try {
                const response = await fetch('/api/match/submit', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        user_id: currentUser.id,
                        match_id: currentMatch.id,
                        answer: answer,
                        time_spent: Math.floor(Math.random() * 180) + 30
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification('–û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! –û–∂–∏–¥–∞–µ–º —Å–æ–ø–µ—Ä–Ω–∏–∫–∞...', 'success');
                    document.getElementById('matchAnswer').value = '';
                    
                    if (wsConnected) {
                        ws.send(JSON.stringify({
                            type: 'answer',
                            match_id: currentMatch.id,
                            answer: answer
                        }));
                    }
                } else {
                    showNotification(data.error, 'error');
                }
            } catch (error) {
                console.error('Submit match answer error:', error);
                showNotification('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞', 'error');
            }
        }

        function startMatchTimer() {
            let seconds = 0;
            const timerElement = document.getElementById('matchTimer');
            if (!timerElement) return;
            
            const timer = setInterval(() => {
                seconds++;
                const minutes = Math.floor(seconds / 60);
                const secs = seconds % 60;
                timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }, 1000);
            
            document.getElementById('pvpPanel').dataset.timer = timer;
        }

        function connectWebSocket() {
            if (wsConnected) return;
            
            try {
                ws = new WebSocket('ws://localhost:8765');
                
                ws.onopen = () => {
                    wsConnected = true;
                    console.log('WebSocket connected');
                    
                    if (currentUser && currentMatch) {
                        ws.send(JSON.stringify({
                            type: 'auth',
                            user_id: currentUser.id,
                            match_id: currentMatch.id
                        }));
                    }
                };
                
                ws.onmessage = (event) => {
                    try {
                        const data = JSON.parse(event.data);
                        handleWebSocketMessage(data);
                    } catch (error) {
                        console.error('WebSocket message error:', error);
                    }
                };
                
                ws.onerror = (error) => {
                    console.error('WebSocket error:', error);
                };
                
                ws.onclose = () => {
                    wsConnected = false;
                    console.log('WebSocket disconnected');
                    setTimeout(connectWebSocket, 5000);
                };
            } catch (error) {
                console.error('WebSocket connection error:', error);
            }
        }

        function handleWebSocketMessage(data) {
            switch(data.type) {
                case 'player_joined':
                    showNotification(`–ò–≥—Ä–æ–∫ ${data.user_id} –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ –º–∞—Ç—á—É`, 'info');
                    break;
                    
                case 'answer_submitted':
                    showNotification(`–°–æ–ø–µ—Ä–Ω–∏–∫ –æ—Ç–ø—Ä–∞–≤–∏–ª –æ—Ç–≤–µ—Ç`, 'info');
                    break;
                    
                case 'chat':
                    break;
                    
                case 'player_left':
                    showNotification(`–ò–≥—Ä–æ–∫ ${data.user_id} –ø–æ–∫–∏–Ω—É–ª –º–∞—Ç—á`, 'info');
                    break;
            }
        }

        async function loadAdminData() {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω', 'error');
                showPanel('problems');
                return;
            }
            
            try {
                const usersResponse = await fetch('/api/users');
                const usersData = await usersResponse.json();
                
                if (usersData.success) {
                    renderUserList(usersData.users);
                }
                
                const statsResponse = await fetch('/api/stats');
                const statsData = await statsResponse.json();
                
                if (statsData.success) {
                    document.getElementById('totalProblemsAdmin').textContent = statsData.stats.problems_count;
                    document.getElementById('adminStats').innerHTML = `
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 20px;">
                            <div style="text-align: center; background: rgba(255, 0, 255, 0.1); padding: 15px; border-radius: 8px; border: 1px solid var(--neon-pink);">
                                <div style="font-size: 1.5em; font-weight: bold; color: var(--neon-pink);">${statsData.stats.users_count}</div>
                                <div style="font-size: 0.9em; color: var(--text-dim);">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                            </div>
                            <div style="text-align: center; background: rgba(0, 243, 255, 0.1); padding: 15px; border-radius: 8px; border: 1px solid var(--neon-blue);">
                                <div style="font-size: 1.5em; font-weight: bold; color: var(--neon-blue);">${statsData.stats.problems_count}</div>
                                <div style="font-size: 0.9em; color: var(--text-dim);">–ó–∞–¥–∞—á</div>
                            </div>
                            <div style="text-align: center; background: rgba(0, 255, 157, 0.1); padding: 15px; border-radius: 8px; border: 1px solid var(--neon-green);">
                                <div style="font-size: 1.5em; font-weight: bold; color: var(--neon-green);">${statsData.stats.correct_solutions}</div>
                                <div style="font-size: 0.9em; color: var(--text-dim);">–†–µ—à–µ–Ω–∏–π</div>
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Load admin data error:', error);
            }
        }

        function renderUserList(users) {
            const container = document.getElementById('userList');
            
            if (users.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 30px; color: var(--text-dim);">–ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>';
                return;
            }
            
            container.innerHTML = users.map(user => `
                <div class="user-item">
                    <div class="user-details">
                        <div style="font-weight: bold; margin-bottom: 5px;">${user.username}</div>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <span class="user-role role-${user.role}">${user.role === 'admin' ? '–ê–¥–º–∏–Ω' : '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}</span>
                            <span style="color: var(--neon-green); font-weight: bold;">üèÜ ${user.rating}</span>
                            ${user.email ? `<span style="color: var(--text-dim); font-size: 0.9em;">${user.email}</span>` : ''}
                        </div>
                    </div>
                    <div class="user-actions">
                        <button class="action-button edit-button" onclick="showEditUserModal(${user.id}, '${user.username}', ${user.rating}, '${user.role}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        ${user.id !== currentUser.id ? `
                            <button class="action-button delete-button" onclick="adminDeleteUser(${user.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        function showModal(modalId) {
            document.getElementById('modalOverlay').style.display = 'block';
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal() {
            document.getElementById('modalOverlay').style.display = 'none';
            document.querySelectorAll('#modalOverlay > div').forEach(modal => {
                modal.style.display = 'none';
            });
        }

        function showAddProblemModal() {
            showModal('addProblemModal');
        }

        async function addProblem() {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω', 'error');
                return;
            }
            
            const title = document.getElementById('modalProblemTitle').value.trim();
            const description = document.getElementById('modalProblemDesc').value.trim();
            const answer = document.getElementById('modalProblemAnswer').value.trim();
            const difficulty = document.getElementById('modalProblemDifficulty').value;
            const category = document.getElementById('modalProblemCategory').value.trim();
            const tags = document.getElementById('modalProblemTags').value.trim();
            
            if (!title || !description || !answer) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            try {
                const response = await fetch('/api/admin/add_problem', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        user_id: currentUser.id,
                        title,
                        description,
                        answer,
                        difficulty,
                        category,
                        tags
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    closeModal();
                    document.getElementById('modalProblemTitle').value = '';
                    document.getElementById('modalProblemDesc').value = '';
                    document.getElementById('modalProblemAnswer').value = '';
                    document.getElementById('modalProblemCategory').value = '–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞';
                    document.getElementById('modalProblemTags').value = '';
                    
                    loadProblems();
                } else {
                    showNotification(data.error, 'error');
                }
            } catch (error) {
                console.error('Add problem error:', error);
                showNotification('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏', 'error');
            }
        }

        function showAddUserModal() {
            showModal('addUserModal');
        }

        async function adminAddUser() {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω', 'error');
                return;
            }
            
            const username = document.getElementById('modalUsername').value.trim();
            const email = document.getElementById('modalUserEmail').value.trim();
            const password = document.getElementById('modalUserPassword').value.trim();
            const role = document.getElementById('modalUserRole').value;
            
            if (!username || !password) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—å', 'error');
                return;
            }
            
            if (password.length < 6) {
                showNotification('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤', 'error');
                return;
            }
            
            try {
                const response = await fetch('/api/admin/add_user', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        admin_id: currentUser.id,
                        username,
                        email,
                        password,
                        role
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    closeModal();
                    document.getElementById('modalUsername').value = '';
                    document.getElementById('modalUserEmail').value = '';
                    document.getElementById('modalUserPassword').value = '';
                    
                    loadAdminData();
                } else {
                    showNotification(data.error, 'error');
                }
            } catch (error) {
                console.error('Add user error:', error);
                showNotification('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error');
            }
        }

        function showEditUserModal(userId, username, rating, role) {
            document.getElementById('editUserId').value = userId;
            document.getElementById('editUsername').value = username;
            document.getElementById('editUserRating').value = rating;
            document.getElementById('editUserRole').value = role;
            showModal('editUserModal');
        }

        async function adminUpdateUser() {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω', 'error');
                return;
            }
            
            const userId = document.getElementById('editUserId').value;
            const rating = document.getElementById('editUserRating').value;
            const role = document.getElementById('editUserRole').value;
            
            try {
                const response = await fetch('/api/admin/update_user', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        admin_id: currentUser.id,
                        user_id: userId,
                        rating: parseInt(rating),
                        role
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    closeModal();
                    loadAdminData();
                } else {
                    showNotification(data.error, 'error');
                }
            } catch (error) {
                console.error('Update user error:', error);
                showNotification('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error');
            }
        }

        async function adminDeleteUser(userId) {
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω', 'error');
                return;
            }
            
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?')) {
                return;
            }
            
            try {
                const response = await fetch('/api/admin/delete_user', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        admin_id: currentUser.id,
                        user_id: userId
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification(data.message, 'success');
                    loadAdminData();
                } else {
                    showNotification(data.error, 'error');
                }
            } catch (error) {
                console.error('Delete user error:', error);
                showNotification('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error');
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            showAuthTab('login');
            
            document.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    if (document.getElementById('authPanel').classList.contains('active')) {
                        if (document.getElementById('loginForm').style.display !== 'none') {
                            login();
                        } else {
                            register();
                        }
                    }
                }
            });
            
            document.getElementById('modalOverlay').addEventListener('click', (e) => {
                if (e.target.id === 'modalOverlay') {
                    closeModal();
                }
            });
        });

        window.platform = {
            login,
            register,
            logout,
            loadProblems,
            submitSolution,
            loadStats,
            loadLeaderboard,
            createMatch,
            joinMatch,
            showPanel,
            showNotification
        };
    </script>
</body>
</html>